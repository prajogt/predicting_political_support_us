---
title: "Predicting Political Support in the United States"
subtitle: "The Effects of Culture and Key Political Choices"
author: 
  - Janssen Myer Rambaud
  - Timothius Prajogi
thanks: "Code and data are available at: https://github.com/prajogt/predicting_political_support_us.git ."
date: today
date-format: long
abstract: "Using data gathered from the 2022 Cooperative Election Study (CES), we navigate through the various possible factors that influence a US citizen's voting decision. By examining a representative sample of 60 000 Americans, we can discern patterns in beliefs and personal backgroundsâ€”ranging from gun control and student loan stances to race, religion, and educational background. This paper discusses the impact these individual factors may have towards predicting a voter's alignment, as well as how multiple factors can coalign to portray a more substantial impact. We aim to highlight these correlations and their potential implications with future elections."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false
#| echo: false

#### Workspace setup ####
library(knitr)
library(tidyverse)
library(modelsummary)
```


# Introduction
include Estimand in here

# Data

These delay statistics were downloaded, cleaned, parsed, analyzed, and visualized using R [@citeR], a statistical programming language, with package support from `tidyverse` [@citetidyverse], a collection of libraries which included the following packages that were utilized: 

* `ggplot2` [@citeggplot] 
* `dplyr` [@citedplyr] 
* `readr` [@citereadr] 
* `tibble` [@citetibble]

The data was retrieved from Harvard's CCES Dataverse database, using the `dataverse` [@citedataverse] package.

In this report we consider data collected from the 2022 CES survey, stored by Dataverse as ***Cooperative Election Study Common Content*** [@citecesdata].

needs measurement

```{r}
#| include: false
#| warning: false
#| message: false
#| echo: false

# Load in data
ces2022_1 <- read_csv("data/cleaned_ces2022_1.csv")
ces2022_2 <- read_csv("data/cleaned_ces2022_2.csv")
```


```{r}
ces2022_1 |>
  ggplot(aes(x = education, fill = voted_for)) +
  stat_count(position = "dodge") +
  facet_wrap(facets = vars(gender)) +
  theme_minimal() +
  labs(
    x = "Highest education",
    y = "Number of respondents",
    fill = "Voted for"
  ) +
  coord_flip() +
  scale_fill_brewer(palette = "Set1") +
  theme(legend.position = "bottom")

```


# Model

```{r}
# Load in models
political_preferences_cultural <-
  readRDS(file = "models/political_preferences_cultural.rds")

political_preferences_race <-
  readRDS(file = "models/political_preferences_race.rds")

political_preferences_importances <-
  readRDS(file = "models/political_preferences_importances.rds")
```


```{r}
#| eval: true
#| fig-cap: "Logistic regression probability results with Gender, Age, Race, and Religion as Predictors"
#| include: true
#| label: fig-modelcultural
#| message: false
#| warning: false

modelsummary(
  list(
    "Support Biden" = political_preferences_cultural
  ),
  statistic = "mad"
  )

```

```{r}
modelsummary(
  list(
    "Support Biden" = political_preferences_importances
  ),
  statistic = "mad"
  )

```



## Results

## Discussion

Although there seems to be a strong correlation between if a voter
identifies as an other gender to supporting Biden, and a strong correlation
between if a voter identifies as an other race to supporting Biden,
but these must be considered carefully as within the sample (with seed 302), 
only 5 and 1 voters identified in those categories respectively. To get a more
accurate reading in regards to these features, it would be necessary to train
a model which includes much more of these demographics.

## Appendix

```{r}
cm <- c('genderMale' = 'Male',
        'raceWhite' = 'White',
        'raceNative American' = 'Native American', 
        'raceMultiracial' = 'Multiracial',
        'raceMiddle Eastern' = 'Middle Eastern',
        'raceHispanic' = 'Hispanic',
        'raceBlack' = 'Black',
        'raceAsian' = 'Asian',
        'religionNone' = 'Non-Religious',
        'religionProtestant' = 'Protestant',
        'religionAgnostic' = 'Agnostic',
        'religionAtheist' = 'Atheist',
        'religionRoman Catholic' = 'Roman Catholic',
        'religionJewish' = 'Jewish',
        'religionOther' = 'Other'
        )

modelplot(political_preferences_cultural, conf_level = 0.9, coef_map = cm) +
  labs(x = "90 per cent credibility interval")
```

```{r}
modelplot(political_preferences_cultural, 
          conf_level = 0.9, 
          coef_map = c("raceOther" = "Other Race", "genderOther" = "Other Gender (Does not Identify as Male or Female)")) + 
  labs(x = "90 per cent credibility interval")
```


## References
